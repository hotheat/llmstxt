<!DOCTYPE html>

<html class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-develop/python/python-sdk-sync-vs-async" data-has-hydrated="false" dir="ltr" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="Docusaurus v3.7.0" name="generator"/>
<title data-rh="true">Temporal Python SDK synchronous vs. asynchronous Activity implementations | Temporal Platform Documentation</title><meta content="width=device-width,initial-scale=1" data-rh="true" name="viewport"/><meta content="summary_large_image" data-rh="true" name="twitter:card"/><meta content="https://docs.temporal.io/img/assets/open-graph-shiny.png" data-rh="true" property="og:image"/><meta content="https://docs.temporal.io/img/assets/open-graph-shiny.png" data-rh="true" name="twitter:image"/><meta content="https://docs.temporal.io/develop/python/python-sdk-sync-vs-async" data-rh="true" property="og:url"/><meta content="en" data-rh="true" property="og:locale"/><meta content="en" data-rh="true" name="docusaurus_locale"/><meta content="en" data-rh="true" name="docsearch:language"/><meta content="follow, index" data-rh="true" name="robots"/><meta content="current" data-rh="true" name="docusaurus_version"/><meta content="docs-default-current" data-rh="true" name="docusaurus_tag"/><meta content="current" data-rh="true" name="docsearch:version"/><meta content="docs-default-current" data-rh="true" name="docsearch:docusaurus_tag"/><meta content="Temporal Python SDK synchronous vs. asynchronous Activity implementations | Temporal Platform Documentation" data-rh="true" property="og:title"/><meta content="The Temporal Python SDK supports implementing Activities asynchronously with asyncio, synchronously with ThreadPoolExecutor or ProcessPoolExecutor. Choose the correct method to avoid application errors." data-rh="true" name="description"/><meta content="The Temporal Python SDK supports implementing Activities asynchronously with asyncio, synchronously with ThreadPoolExecutor or ProcessPoolExecutor. Choose the correct method to avoid application errors." data-rh="true" property="og:description"/><meta content="temporal python sdk,asynchronous activities,synchronous activities,asyncio python,multiprocessing.managers.syncmanager,python async event loop,blocking calls in python,aiohttp vs requests,python multithreading,python multiprocessing,async safe http library,http requests in python activities,activity implementation in temporal,async-vs-sync" data-rh="true" name="keywords"/><link data-rh="true" href="/img/favicon.svg" rel="icon"/><link data-rh="true" href="https://docs.temporal.io/develop/python/python-sdk-sync-vs-async" rel="canonical"/><link data-rh="true" href="https://docs.temporal.io/develop/python/python-sdk-sync-vs-async" hreflang="en" rel="alternate"/><link data-rh="true" href="https://docs.temporal.io/develop/python/python-sdk-sync-vs-async" hreflang="x-default" rel="alternate"/><link crossorigin="anonymous" data-rh="true" href="https://T5D6KNJCQS-dsn.algolia.net" rel="preconnect"/><link href="/opensearch.xml" rel="search" title="Temporal Platform Documentation" type="application/opensearchdescription+xml"/>
<link href="https://cdn.jsdelivr.net/npm/pushfeedback@latest/dist/pushfeedback/pushfeedback.css" rel="stylesheet"/>
<link as="document" href="https://iq.temporal.io" rel="preload"/>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" rel="stylesheet"/>
<script async="" defer="defer" src="/scripts/googletag.js"></script>
<script async="" data-modal-disclaimer="I am Temporal's AI developer assistant. I can access developer docs, forum posts, product blogs, and SDK references. Responses are generated by combining various sources to provide the best possible answer, however I may not be fully accurate, so please use your best judgement. If you have feedback please give a thumbs up or down as I continue to improve." data-modal-example-questions="What is Temporal?,How do I get started using Temporal?,I need a Workflow written in TypeScript,How do Signals work?" data-modal-title="Temporal's AI developer assistant" data-project-color="#000000" data-project-logo="https://avatars.githubusercontent.com/u/56493103?s=280&amp;v=4" data-project-name="Temporal" data-user-analytics-fingerprint-enabled="" data-website-id="91a88508-9cdc-441f-b1df-37aa9329e6bc" defer="defer" src="https://widget.kapa.ai/kapa-widget.bundle.js"></script>
<script async="" defer="defer" src="/scripts/copycode-notice.js"></script><link href="/assets/css/styles.50233c8a.css" rel="stylesheet"/>
<script defer="defer" src="/assets/js/runtime~main.f7e0581b.js"></script>
<script defer="defer" src="/assets/js/main.a2d776b6.js"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div aria-label="Skip to main content" role="region"><a class="skipToContent_QtLt" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-expanded="false" aria-label="Toggle navigation bar" class="navbar__toggle clean-btn" type="button"><svg aria-hidden="true" height="30" viewbox="0 0 30 30" width="30"><path d="M4 7h22M4 15h22M4 23h22" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"></path></svg></button><a class="navbar__brand" href="https://temporal.io" rel="noopener noreferrer" target="_blank"><div class="navbar__logo"><img alt="Temporal logo" class="themedComponent_kHbU themedComponent--light_tqeZ" src="/img/assets/temporal-logo-dark.svg"/><img alt="Temporal logo" class="themedComponent_kHbU themedComponent--dark_TUss" src="/img/assets/temporal-logo.svg"/></div></a><a class="navbar__item navbar__link" href="/">Home</a><a class="navbar__item navbar__link" href="https://learn.temporal.io/getting_started/" rel="noopener noreferrer" right="left" target="_blank">Start learning<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a><a class="navbar__item navbar__link" href="/develop" right="left">Start building</a><a class="navbar__item navbar__link" href="https://temporal.io/code-exchange" rel="noopener noreferrer" right="left" target="_blank">Code Exchange<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a><a class="navbar__item navbar__link" href="/cloud">Temporal Cloud</a></div><div class="navbar__items navbar__items--right"><div class="toggle_V9xM colorModeToggle_kzWL"><button aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false" class="clean-btn toggleButton_U5xw toggleButtonDisabled_Y6vk" disabled="" title="Switch between dark and light mode (currently light mode)" type="button"><svg class="lightToggleIcon_IKzY" height="24" viewbox="0 0 24 24" width="24"><path d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z" fill="currentColor"></path></svg><svg class="darkToggleIcon_BLKw" height="24" viewbox="0 0 24 24" width="24"><path d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z" fill="currentColor"></path></svg></button></div><div class="navbarSearchContainer_Lkee"><button aria-label="Search (Command+K)" class="DocSearch DocSearch-Button" type="button"><span class="DocSearch-Button-Container"><svg aria-hidden="true" class="DocSearch-Search-Icon" height="20" viewbox="0 0 20 20" width="20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div class="navbar-sidebar__backdrop" role="presentation"></div></nav><div class="main-wrapper mainWrapper_HmbK" id="__docusaurus_skipToContent_fallback"><div class="docsWrapper_ruNH"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_JnKz" type="button"></button><div class="docRoot_y6yc"><aside class="theme-doc-sidebar-container docSidebarContainer_hpwb"><div class="sidebarViewport_bkwQ"><div class="sidebar_mhwn"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_KoUK"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Documentation Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/evaluate/">Evaluate</a><button aria-expanded="true" aria-label="Collapse sidebar category 'Evaluate'" class="clean-btn menu__caret" type="button"></button></div><ul class="menu__list" style="display:block;overflow:visible;height:auto"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/evaluate/why-temporal" tabindex="0">Why Temporal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/evaluate/understanding-temporal" tabindex="0">Understanding Temporal</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/evaluate/development-production-features/" tabindex="0">Features</a><button aria-expanded="false" aria-label="Expand sidebar category 'Features'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cloud/introduction" tabindex="0">Temporal Cloud</a><button aria-expanded="false" aria-label="Expand sidebar category 'Temporal Cloud'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/security" tabindex="0">Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/evaluate/use-cases-design-patterns" tabindex="0">Use Cases</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menuExternalLink_Pkvp" href="https://learn.temporal.io/getting_started/" rel="noopener noreferrer" target="_blank">Get started<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/develop/">Develop</a><button aria-expanded="true" aria-label="Collapse sidebar category 'Develop'" class="clean-btn menu__caret" type="button"></button></div><ul class="menu__list" style="display:block;overflow:visible;height:auto"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/develop/go/" tabindex="0">Go SDK</a><button aria-expanded="false" aria-label="Expand sidebar category 'Go SDK'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/develop/java/" tabindex="0">Java SDK</a><button aria-expanded="false" aria-label="Expand sidebar category 'Java SDK'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/develop/php/" tabindex="0">PHP SDK</a><button aria-expanded="false" aria-label="Expand sidebar category 'PHP SDK'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/develop/python/" tabindex="0">Python SDK</a><button aria-expanded="true" aria-label="Collapse sidebar category 'Python SDK'" class="clean-btn menu__caret" type="button"></button></div><ul class="menu__list" style="display:block;overflow:visible;height:auto"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/core-application" tabindex="0">Core application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/temporal-clients" tabindex="0">Temporal Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/python-sdk-sandbox" tabindex="0">Python SDK sandbox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/develop/python/python-sdk-sync-vs-async" tabindex="0">Python SDK sync vs async</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/testing-suite" tabindex="0">Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/failure-detection" tabindex="0">Failure detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/message-passing" tabindex="0">Messages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/cancellation" tabindex="0">Interrupt a Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/asynchronous-activity-completion" tabindex="0">Asynchronous Activity Completion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/versioning" tabindex="0">Versioning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/observability" tabindex="0">Observability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/debugging" tabindex="0">Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/schedules" tabindex="0">Schedules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/converters-and-encryption" tabindex="0">Converters and encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/timers" tabindex="0">Durable Timers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/child-workflows" tabindex="0">Child Workflows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" href="/develop/python/continue-as-new" tabindex="0">Continue-As-New</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/develop/typescript/" tabindex="0">TypeScript SDK</a><button aria-expanded="false" aria-label="Expand sidebar category 'TypeScript SDK'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/develop/dotnet/" tabindex="0">.NET SDK</a><button aria-expanded="false" aria-label="Expand sidebar category '.NET SDK'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/develop/activity-retry-simulator" tabindex="0">Activity retry simulator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/develop/worker-performance" tabindex="0">Worker performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/develop/safe-deployments" tabindex="0">Safe deployments</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/production-deployment">Deploy to production</a><button aria-expanded="true" aria-label="Collapse sidebar category 'Deploy to production'" class="clean-btn menu__caret" type="button"></button></div><ul class="menu__list" style="display:block;overflow:visible;height:auto"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cloud" tabindex="0">Temporal Cloud</a><button aria-expanded="false" aria-label="Expand sidebar category 'Temporal Cloud'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/production-deployment/data-encryption" tabindex="0">Codecs and Encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/production-deployments/migration" tabindex="0">Migrate to Cloud</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/self-hosted-guide" tabindex="0">Self-host</a><button aria-expanded="false" aria-label="Expand sidebar category 'Self-host'" class="clean-btn menu__caret" type="button"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cli">CLI (temporal)</a><button aria-expanded="false" aria-label="Expand sidebar category 'CLI (temporal)'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/references/">References</a><button aria-expanded="false" aria-label="Expand sidebar category 'References'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/troubleshooting/">Troubleshooting</a><button aria-expanded="false" aria-label="Expand sidebar category 'Troubleshooting'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/encyclopedia/">Encyclopedia</a><button aria-expanded="false" aria-label="Expand sidebar category 'Encyclopedia'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/glossary">Glossary</a></li></ul></nav><button aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_EBp1" title="Collapse sidebar" type="button"><svg aria-hidden="true" class="collapseSidebarButtonIcon_Snxh" height="20" width="20"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_iQPe"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_rCpc"><div class="docItemContainer_hbe2"><article><nav aria-label="Breadcrumbs" class="theme-doc-breadcrumbs breadcrumbsContainer_qWNH"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg class="breadcrumbHomeIcon_Xhh_" viewbox="0 0 24 24"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item" itemprop="itemListElement" itemscope="" itemtype="https://schema.org/ListItem"><a class="breadcrumbs__link" href="/develop/" itemprop="item"><span itemprop="name">Develop</span></a><meta content="1" itemprop="position"/></li><li class="breadcrumbs__item" itemprop="itemListElement" itemscope="" itemtype="https://schema.org/ListItem"><a class="breadcrumbs__link" href="/develop/python/" itemprop="item"><span itemprop="name">Python SDK</span></a><meta content="2" itemprop="position"/></li><li class="breadcrumbs__item breadcrumbs__item--active" itemprop="itemListElement" itemscope="" itemtype="https://schema.org/ListItem"><span class="breadcrumbs__link" itemprop="name">Python SDK sync vs async</span><meta content="3" itemprop="position"/></li></ul></nav><div class="tocCollapsible_N7Vh theme-doc-toc-mobile tocMobile_Ntak"><button class="clean-btn tocCollapsibleButton_ZY7A" type="button">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Temporal Python SDK synchronous vs. asynchronous Activity implementations</h1></header><p>The Temporal Python SDK supports multiple ways of implementing an Activity:</p>
<ul>
<li>Asynchronously using <a href="https://docs.python.org/3/library/asyncio.html" rel="noopener noreferrer" target="_blank"><code>asyncio</code></a></li>
<li>Synchronously multithreaded using <a href="https://docs.python.org/3/library/concurrent.futures.html#threadpoolexecutor" rel="noopener noreferrer" target="_blank"><code>concurrent.futures.ThreadPoolExecutor</code></a></li>
<li>Synchronously multiprocess using <a href="https://docs.python.org/3/library/concurrent.futures.html#processpoolexecutor" rel="noopener noreferrer" target="_blank"><code>concurrent.futures.ProcessPoolExecutor</code></a> and <a href="https://docs.python.org/3/library/multiprocessing.html#multiprocessing.managers.SyncManager" rel="noopener noreferrer" target="_blank"><code>multiprocessing.managers.SyncManager</code></a></li>
</ul>
<p>It is important to implement your Activities using the correct method, otherwise
your application may fail in sporadic and unexpected ways. Which one you should
use depends on your use case. This section provides guidance to help you choose
the best approach.</p>
<h2 class="anchor anchorWithStickyNavbar_cvba" id="the-python-asynchronous-event-loop-and-blocking-calls">The Python Asynchronous Event Loop and Blocking Calls<a aria-label="Direct link to The Python Asynchronous Event Loop and Blocking Calls" class="hash-link" href="#the-python-asynchronous-event-loop-and-blocking-calls" title="Direct link to The Python Asynchronous Event Loop and Blocking Calls">​</a></h2>
<p>First, let's look at how async event loops work in Python. The Python async
event loop runs in a thread and executes all tasks in its thread. When any
task is running in the event loop, the loop is blocked and no other tasks can be
running at the same time within that event loop. Whenever a task executes an
<code>await</code> expression, the task is suspended, and the event loop begins or resumes
execution of another task.</p>
<p>This means that the event loop can only pass the flow of control when the <code>await</code>
keyword is executed. If a program makes a blocking call, such as one that reads
from a file, makes a synchronous request to a network service, waits for user input,
or anything else that blocks the execution, the entire event loop must wait until
that execution has completed.</p>
<p>Blocking the async event loop in Python would turn your asynchronous program
into a synchronous program that executes serially, defeating the entire purpose
of using <code>asyncio</code>. This can also lead to potential deadlock, and unpredictable behavior
that causes tasks to be unable to execute. Debugging these issues can be difficult
and time consuming, as locating the source of the blocking call might not always
be immediately evident.</p>
<p>Due to this, Python developers must be extra careful to not make blocking calls
from within an asynchronous Activity, or use an async safe library to perform
these actions.</p>
<p>For example, making an HTTP call with the popular <code>requests</code> library within an
asynchronous Activity would lead to blocking your event loop. If you want to make
an HTTP call from within an asynchronous Activity, you should use an async-safe HTTP library
such as <code>aiohttp</code> or <code>httpx</code>. Otherwise, use a synchronous Activity.</p>
<h2 class="anchor anchorWithStickyNavbar_cvba" id="python-sdk-worker-execution-architecture">Python SDK Worker Execution Architecture<a aria-label="Direct link to Python SDK Worker Execution Architecture" class="hash-link" href="#python-sdk-worker-execution-architecture" title="Direct link to Python SDK Worker Execution Architecture">​</a></h2>
<p>Python workers have following components for executing code:</p>
<ul>
<li>Your event loop, which runs Tasks from async Activities <strong>plus the rest of the Temporal Worker, such as communicating with the server</strong>.</li>
<li>An executor for executing Activity Tasks from synchronous Activities. A thread pool executor is recommended.</li>
<li>A thread pool executor for executing Workflow Tasks.</li>
</ul>
<blockquote>
<p>See Also: <a href="https://python.temporal.io/temporalio.worker.Worker.html#__init__" rel="noopener noreferrer" target="_blank">docs for</a> <code>worker.__init__()</code></p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_cvba" id="activities">Activities<a aria-label="Direct link to Activities" class="hash-link" href="#activities" title="Direct link to Activities">​</a></h3>
<ul>
<li>Async Activities and the temporal worker SDK code both run the default asyncio event loop or whatever event loop you give the Worker.</li>
<li>Synchronous Activities run in the <code>activity_executor</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_cvba" id="workflows">Workflows<a aria-label="Direct link to Workflows" class="hash-link" href="#workflows" title="Direct link to Workflows">​</a></h3>
<p>Since Workflow Tasks have the following three properties, they're run in threads.</p>
<ul>
<li>are CPU bound</li>
<li>need to be timed out for deadlock detection</li>
<li>need to not block other Workflow Tasks</li>
</ul>
<p>The <code>workflow_task_executor</code> is the thread pool these Tasks are run on.
The fact that Workflow Tasks run in a thread pool can be confusing at first because Workflow Definitions are <code>async</code>.
The key differentiator is that the <code>async</code> in Workflow Definitions isn't referring to the standard event loop -- it's referring to the Workflow's own event loop.
Each Workflow gets its own “Workflow event loop,” which is deterministic, and described in <a href="https://temporal.io/blog/durable-distributed-asyncio-event-loop#temporal-workflows-are-asyncio-event-loops" rel="noopener noreferrer" target="_blank">the Python SDK blog</a>.
The Workflow event loop doesn't constantly loop -- it just gets cycled through during a Workflow Task to make as much progress as possible on all of its futures.
When it can no longer make progress on any of its futures, then the Workflow Task is complete.</p>
<h3 class="anchor anchorWithStickyNavbar_cvba" id="number-of-cpu-cores">Number of CPU cores<a aria-label="Direct link to Number of CPU cores" class="hash-link" href="#number-of-cpu-cores" title="Direct link to Number of CPU cores">​</a></h3>
<p>The only ways to use more than one core in a python Worker (considering Python's GIL) are:</p>
<ul>
<li>Run more than one Worker Process.</li>
<li>Run the synchronous Activities in a process pool executor, but a thread pool executor is recommended.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_cvba" id="a-worker-infrastructure-option-separate-activity-and-workflow-workers">A Worker infrastructure option: Separate Activity and Workflow Workers<a aria-label="Direct link to A Worker infrastructure option: Separate Activity and Workflow Workers" class="hash-link" href="#a-worker-infrastructure-option-separate-activity-and-workflow-workers" title="Direct link to A Worker infrastructure option: Separate Activity and Workflow Workers">​</a></h3>
<p>To reduce the risk of event loops or executors getting blocked,
some users choose to deploy separate Workers for Workflow Tasks and Activity Tasks.</p>
<h2 class="anchor anchorWithStickyNavbar_cvba" id="activity-definition">Activity Definition<a aria-label="Direct link to Activity Definition" class="hash-link" href="#activity-definition" title="Direct link to Activity Definition">​</a></h2>
<p><strong>By default, Activities should be synchronous rather than asynchronous</strong>.
You should only make an Activity asynchronous if you are
certain that it doesn't block the event loop.</p>
<p>This is because if you have blocking code in an <code>async def</code> function,
it blocks your event loop and the rest of Temporal, which can cause bugs that are
hard to diagnose, including freezing your worker and blocking Workflow progress
(because Temporal can't tell the server that Workflow Tasks are completing).
The reason synchronous Activities help is because they
run in the <code>activity_executor</code> (<a href="https://python.temporal.io/temporalio.worker.Worker.html#__init__" rel="noopener noreferrer" target="_blank">docs for</a> <code>worker.__init__()</code>)
rather than in the global event loop,
which helps because:</p>
<ul>
<li>There's no risk of accidentally blocking the global event loop.</li>
<li>If you have multiple
Activity Tasks running in a thread pool rather than an event loop, one bad
Activity Task can't slow down the others; this is because the OS scheduler preemptively
switches between threads, which the event loop coordinator doesn't do.</li>
</ul>
<blockquote>
<p>See Also:
<a href="https://github.com/temporalio/sdk-python#types-of-activities" rel="noopener noreferrer" target="_blank">"Types of Activities" section of Python SDK README</a></p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_cvba" id="how-to-implement-synchronous-activities">How to implement Synchronous Activities<a aria-label="Direct link to How to implement Synchronous Activities" class="hash-link" href="#how-to-implement-synchronous-activities" title="Direct link to How to implement Synchronous Activities">​</a></h2>
<p>The following code is a synchronous Activity Definition.
It takes a name (<code>str</code>) as input and returns a
customized greeting (<code>str</code>) as output.</p>
<p>It makes a call to a microservice, and when making this call,
you'll notice that it uses the <code>requests</code> library. This is safe to do in
synchronous Activities.</p>
<div class="language-python codeBlockContainer_WhOs theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_G9nB"><pre class="prism-code language-python codeBlock_FQ16 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e" tabindex="0"><code class="codeBlockLines_VK93"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">parse</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> requests</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> temporalio </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> activity</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">TranslateActivities</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@activity</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">defn</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">greet_in_spanish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        greeting </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">call_service</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"get-spanish-greeting"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> greeting</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Utility method for making calls to the microservices</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">call_service</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> stem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        base </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"http://localhost:9999/</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">stem</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        url </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">base</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">?name=</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">urllib</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">parse</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">quote</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation">name</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        response </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">text</span><br/></span></code></pre><div class="buttonGroup_B2Le"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_qw2X"><svg class="copyButtonIcon_iWSc" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_ksad" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div>
<p>The preceeding example doesn't share a session across the Activity, so
<code>__init__</code> was removed. While <code>requests</code> does have the ability to create sessions,
it's currently unknown if they're thread safe. Due to no longer having or needing
<code>__init__</code>, the case could be made here to not implement the Activities as a class,
but just as decorated functions as shown here:</p>
<div class="language-python codeBlockContainer_WhOs theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_G9nB"><pre class="prism-code language-python codeBlock_FQ16 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e" tabindex="0"><code class="codeBlockLines_VK93"><span class="token-line" style="color:#bfc7d5"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@activity</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">defn</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">greet_in_spanish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    greeting </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> call_service</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"get-spanish-greeting"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> greeting</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Utility method for making calls to the microservices</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">call_service</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">stem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    base </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"http://localhost:9999/</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">stem</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    url </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">base</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">?name=</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">urllib</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">parse</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">quote</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation">name</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    response </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">text</span><br/></span></code></pre><div class="buttonGroup_B2Le"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_qw2X"><svg class="copyButtonIcon_iWSc" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_ksad" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div>
<p>Whether to implement Activities as class methods or functions is a design
choice left up to the developer when cross-activity state isn't needed. Both are
equally valid implementations.</p>
<h3 class="anchor anchorWithStickyNavbar_cvba" id="how-to-run-synchronous-activities-on-a-worker">How to run Synchronous Activities on a Worker<a aria-label="Direct link to How to run Synchronous Activities on a Worker" class="hash-link" href="#how-to-run-synchronous-activities-on-a-worker" title="Direct link to How to run Synchronous Activities on a Worker">​</a></h3>
<p>When running synchronous Activities, the Worker
needs to have an <code>activity_executor</code>. Temporal
recommends using a <code>ThreadPoolExecutor</code> as shown here:</p>
<div class="language-python codeBlockContainer_WhOs theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_G9nB"><pre class="prism-code language-python codeBlock_FQ16 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e" tabindex="0"><code class="codeBlockLines_VK93"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">with</span><span class="token plain"> ThreadPoolExecutor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">max_workers</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">42</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> executor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    worker </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Worker</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ...</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        activity_executor</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">executor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ...</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br/></span></code></pre><div class="buttonGroup_B2Le"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_qw2X"><svg class="copyButtonIcon_iWSc" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_ksad" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_cvba" id="how-to-implement-asynchronous-activities">How to Implement Asynchronous Activities<a aria-label="Direct link to How to Implement Asynchronous Activities" class="hash-link" href="#how-to-implement-asynchronous-activities" title="Direct link to How to Implement Asynchronous Activities">​</a></h2>
<p>The following code is an implementation of the preceeding Activity, but as an
asynchronous Activity Definition.</p>
<p>It makes
a call to a microservice, accessed through HTTP, to request this
greeting in Spanish. This Activity uses the <code>aiohttp</code> library to make an async
safe HTTP request. Using the <code>requests</code> library here would have resulting in
blocking code within the async event loop, which will block the entire async
event loop. For more in-depth information about this issue, refer to the
<a href="https://docs.python.org/3/library/asyncio-dev.html#running-blocking-code" rel="noopener noreferrer" target="_blank">Python asyncio documentation</a>.</p>
<p>The following code also implements the Activity Definition as a class, rather than a
function. The <code>aiohttp</code> library requires an established <code>Session</code> to perform the
HTTP request. It would be inefficient to establish a <code>Session</code> every time an
Activity is invoked, so instead this code accepts a <code>Session</code> object as an instance
parameter and makes it available to the methods. This approach will also be
beneficial when the execution is over and the <code>Session</code> needs to be closed.</p>
<p>In this example, the Activity supplies the name in the URL and retrieves
the greeting from the body of the response.</p>
<div class="language-python codeBlockContainer_WhOs theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_G9nB"><pre class="prism-code language-python codeBlock_FQ16 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e" tabindex="0"><code class="codeBlockLines_VK93"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> aiohttp</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">parse</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> temporalio </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> activity</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">TranslateActivities</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> session</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> aiohttp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ClientSession</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">session </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> session</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@activity</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">defn</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">greet_in_spanish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        greeting </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">call_service</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"get-spanish-greeting"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> greeting</span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Utility method for making calls to the microservices</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">call_service</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> stem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        base </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"http://localhost:9999/</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">stem</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        url </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">base</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">?name=</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">urllib</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">parse</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">quote</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation">name</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">with</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            translation </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">text</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">status </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">400</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ApplicationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"HTTP Error </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">status</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">translation</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># We want to have Temporal automatically retry 5xx but not 4xx</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    non_retryable</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">status </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">500</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> translation</span><br/></span></code></pre><div class="buttonGroup_B2Le"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_qw2X"><svg class="copyButtonIcon_iWSc" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_ksad" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_cvba" id="how-to-run-synchronous-code-from-an-asynchronous-activity">How to run synchronous code from an asynchronous activity<a aria-label="Direct link to How to run synchronous code from an asynchronous activity" class="hash-link" href="#how-to-run-synchronous-code-from-an-asynchronous-activity" title="Direct link to How to run synchronous code from an asynchronous activity">​</a></h3>
<p>If your Activity is asynchronous and you don't want to change it to synchronous,
but you need to run blocking code inside it,
then you can use python utility functions to run synchronous code
in an asynchronous function:</p>
<ul>
<li><a href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.loop.run_in_executor" rel="noopener noreferrer" target="_blank"><code>loop.run_in_executor()</code></a>, which is also mentioned in the <a href="https://docs.python.org/3/library/asyncio-dev.html#running-blocking-code" rel="noopener noreferrer" target="_blank">"running blocking code" section of the "developing with asyncio" guide</a></li>
<li><a href="https://docs.python.org/3/library/asyncio-task.html#running-in-threads" rel="noopener noreferrer" target="_blank"><code>asyncio.to_thread()</code></a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_cvba" id="when-should-you-use-async-activities">When Should You Use Async Activities<a aria-label="Direct link to When Should You Use Async Activities" class="hash-link" href="#when-should-you-use-async-activities" title="Direct link to When Should You Use Async Activities">​</a></h2>
<p>Asynchronous Activities have many advantages, such as potential speed up of execution.
However, as discussed above, making unsafe calls within the async event loop
can cause sporadic and difficult to diagnose bugs. For this reason, we recommend
using asynchronous Activities <em>only</em> when you are certain that your Activities
are async safe and don't make blocking calls.</p>
<p>If you experience bugs that you think may be a result of an unsafe call being made in an asynchronous Activity, convert it to a synchronous Activity and see if the issue resolves.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_ehQq padding--none margin-left--sm"><li class="tag_BQf1"><a class="tag_CFAW tagRegular_aCRj" href="/tags/temporal-sd-ks">Temporal SDKs</a></li><li class="tag_BQf1"><a class="tag_CFAW tagRegular_aCRj" href="/tags/python-sdk">Python SDK</a></li><li class="tag_BQf1"><a class="tag_CFAW tagRegular_aCRj" href="/tags/concepts">Concepts</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><div style="margin-top:20px;padding:10px 15px;border-radius:8px;border-left:4px solid #007bff;display:flex;flex-direction:column;align-items:flex-start"><p style="margin:0;font-weight:500">Help us make Temporal better. Contribute to our <a href="https://github.com/temporalio/documentation">documentation</a>.</p></div></div><div class="col lastUpdated_oLxI"></div></div></footer></article><nav aria-label="Docs pages" class="pagination-nav docusaurus-mt-lg"><a class="pagination-nav__link pagination-nav__link--prev" href="/develop/python/python-sdk-sandbox"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Python SDK sandbox</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/develop/python/testing-suite"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_DY1A thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="#the-python-asynchronous-event-loop-and-blocking-calls">The Python Asynchronous Event Loop and Blocking Calls</a></li><li><a class="table-of-contents__link toc-highlight" href="#python-sdk-worker-execution-architecture">Python SDK Worker Execution Architecture</a><ul><li><a class="table-of-contents__link toc-highlight" href="#activities">Activities</a></li><li><a class="table-of-contents__link toc-highlight" href="#workflows">Workflows</a></li><li><a class="table-of-contents__link toc-highlight" href="#number-of-cpu-cores">Number of CPU cores</a></li><li><a class="table-of-contents__link toc-highlight" href="#a-worker-infrastructure-option-separate-activity-and-workflow-workers">A Worker infrastructure option: Separate Activity and Workflow Workers</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="#activity-definition">Activity Definition</a></li><li><a class="table-of-contents__link toc-highlight" href="#how-to-implement-synchronous-activities">How to implement Synchronous Activities</a><ul><li><a class="table-of-contents__link toc-highlight" href="#how-to-run-synchronous-activities-on-a-worker">How to run Synchronous Activities on a Worker</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="#how-to-implement-asynchronous-activities">How to Implement Asynchronous Activities</a><ul><li><a class="table-of-contents__link toc-highlight" href="#how-to-run-synchronous-code-from-an-asynchronous-activity">How to run synchronous code from an asynchronous activity</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="#when-should-you-use-async-activities">When Should You Use Async Activities</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://github.com/temporalio" rel="noopener noreferrer" target="_blank">Github<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://twitter.com/temporalio" rel="noopener noreferrer" target="_blank">Twitter<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://www.youtube.com/c/Temporalio" rel="noopener noreferrer" target="_blank">YouTube<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://github.com/temporalio/documentation/blob/master/README.md" rel="noopener noreferrer" target="_blank">About the docs<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://temporal.io/cloud" rel="noopener noreferrer" target="_blank">Temporal Cloud<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://temporal.io/community#events" rel="noopener noreferrer" target="_blank">Meetups<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://temporal.io/community#workshops" rel="noopener noreferrer" target="_blank">Workshops<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://community.temporal.io/" rel="noopener noreferrer" target="_blank">Support forum<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://pages.temporal.io/ask-an-expert" rel="noopener noreferrer" target="_blank">Ask an expert<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://learn.temporal.io" rel="noopener noreferrer" target="_blank">Learn Temporal<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://temporal.io/blog" rel="noopener noreferrer" target="_blank">Blog<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://temporal.io/use-cases" rel="noopener noreferrer" target="_blank">Use cases<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://pages.temporal.io/newsletter-subscribe" rel="noopener noreferrer" target="_blank">Newsletter signup<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/security">Security</a></li><li class="footer__item"><a class="footer__link-item" href="https://temporal.io/global-privacy-policy" rel="noopener noreferrer" target="_blank">Privacy policy</a></li><li class="footer__item"><a class="footer__link-item" href="https://docs.temporal.io/pdf/temporal-tos-2021-07-24.pdf" rel="noopener noreferrer" target="_blank">Terms of service<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://temporal.io/careers" rel="noopener noreferrer" target="_blank">We're hiring<svg aria-hidden="true" class="iconExternalLink_CtLf" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_AhxU" href="https://temporal.io" rel="noopener noreferrer"><img alt="Temporal logo" class="footer__logo themedComponent_kHbU themedComponent--light_tqeZ" src="/img/favicon.png" width="24"/><img alt="Temporal logo" class="footer__logo themedComponent_kHbU themedComponent--dark_TUss" src="/img/favicon.png" width="24"/></a></div><div class="footer__copyright">Copyright © 2025 Temporal Technologies Inc.</div><noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-TSXFPF2" style="display:none;visibility:hidden" width="0"></iframe></noscript></div></div></footer></div>
<script src="https://cdn.jsdelivr.net/npm/pushfeedback@latest/dist/pushfeedback/pushfeedback.esm.js" type="module"></script>
<script>const feedbackButton=document.createElement("feedback-button");feedbackButton.setAttribute("project","6c1ptrxbky"),feedbackButton.setAttribute("modal-position","sidebar-right"),feedbackButton.setAttribute("button-style","light"),feedbackButton.setAttribute("button-position","center-right"),feedbackButton.setAttribute("privacy-policy-text","false"),feedbackButton.setAttribute("modal-title","Feedback"),feedbackButton.setAttribute("id","default"),feedbackButton.textContent="Feedback",document.body.appendChild(feedbackButton)</script></body>
</html>